--- Fog to Cloud Key Exchange ---
Fog to Cloud key exchange initiated...
Generating r and TS...
Generated r: 319, TS: 1724778513
Multiplying point <EllipticCurvePublicNumbers(curve=secp384r1, x=5946830649239251893899264988495385356214287398226785304828813044562742833371473282318866412396652326086025704414627, y=7831192260376431889608877000878339200172357441636128111563370290348918545832615050943305609555876292718516395752863)> by scalar 319 using Double and Add method...
Multiplying point <EllipticCurvePublicNumbers(curve=secp384r1, x=26247035095799689268623156744566981891852923491109213387815615900925518854738050089022388053975719786650872476732087, y=8325710961489029985546751289520108179287853048861315594709205902480503199884419224438643760392947333078086511627871)> by scalar 319 using Double and Add method...
G5_bytes: 905936a6d947a21309acae8fa5ec4f93a4c8b15de4553145b7c1a57a20eca00317c548394f2fceb5221630db53d8122b
Cf: 22217266031646785614026562784949615093960317721290249292496751461073936711826340476902215784923102911826254908837459
RIDf: 9929319425108695200469254677788105739532647771943662287370544943641712979402077114794193147607285415148984446181455
M3: 12b223f318edb5a1470479f7d92ba35fd8a48f7a9004dfd23fec46f3d4f4b01c
Message to Cloud: {'CIDf': b'Kcl\x10\x87\x0c\xca}\xbc\xd9\xc3\x81f\x9aa\x196\x88\xb3,ZN\x15\xd52O\x87\\$\xb2\x18$', 'RIDf': 9929319425108695200469254677788105739532647771943662287370544943641712979402077114794193147607285415148984446181455, 'TS3': 1724778513, 'M3': b'\x12\xb2#\xf3\x18\xed\xb5\xa1G\x04y\xf7\xd9+\xa3_\xd8\xa4\x8fz\x90\x04\xdf\xd2?\xecF\xf3\xd4\xf4\xb0\x1c'}

--- Cloud to Fog Response ---
Cloud processing response from Fog...
Received TS3: 1724778513, Current TS: 1724778513
Multiplying point <EllipticCurvePublicNumbers(curve=secp384r1, x=37441821065835489758244055761338634701192263791511723527646344053627394306334251060743167196654837746586674312301708, y=20178024562974156657892488915793151351005300762710026334482298267628989714236360273290253807412281158462891259349224)> by scalar 1829150395586860099105702652303145944710529214592481595624475996345420740649398481790849534910205226287289156177399 using Double and Add method...
G_prime_5: <EllipticCurvePublicNumbers(curve=secp384r1, x=22217266031646785614026562784949615093980297939354006681303484755094250780837266443989860526197775305907722085995051, y=2843319386858506816208130679839366603589194590307690354811733996123700222150124011488577429960022853592219089519204)>
G_prime_5_bytes: 905936a6d947a21309acae8fa5ec4f93a4c8b15de4553145b7c1a57a20eca00317c548394f2fceb5221630db53d8122b
self.fog_n: 9929319425108695200469254677788105739556679656466355024888042866919434141704931302326461929101113235337736044599060
Cf_prime: 22217266031646785614026562784949615093960317721290249292496751461073936711826340476902215784923102911826254908837459
Traceback (most recent call last):
  File "c:\Users\erhan\OneDrive\Masa端st端\authentication_scheme\src\phases\key_exchange.py", line 405, in <module>
    message_from_cloud = key_exchange.cloud_response(message_to_cloud, r3, G5, G6)
  File "c:\Users\erhan\OneDrive\Masa端st端\authentication_scheme\src\phases\key_exchange.py", line 284, in cloud_response
    raise ValueError("M3 verification failed")
ValueError: M3 verification failed





-------------------------------------------------------------------------------------------------------------------------------------
